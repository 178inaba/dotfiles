# tmux チートシート

## 基本操作

### セッション管理
| コマンド | 説明 |
|---------|------|
| `tmux` | 新しいセッションを開始 |
| `tmux new -s <名前>` | 名前付きセッションを作成 |
| `prefix + d` | セッションをデタッチ（一時的に離脱） |
| `tmux attach` | 最後のセッションに再接続 |
| `tmux attach -t <名前>` | 指定セッションに再接続 |
| `tmux list-sessions` | セッション一覧を表示 |
| `tmux kill-session -t <名前>` | セッションを終了 |

## ペイン操作（画面分割）

### 基本分割
| キー | 説明 |
|-----|------|
| `prefix + \|` | 縦に分割 |
| `prefix + -` | 横に分割 |
| `prefix + x` | 現在のペインを閉じる |

### ペイン間移動
| キー | 説明 |
|-----|------|
| `prefix + h` | 左のペインに移動 |
| `prefix + j` | 下のペインに移動 |
| `prefix + k` | 上のペインに移動 |
| `prefix + l` | 右のペインに移動 |
| `prefix + 矢印キー` | 矢印方向のペインに移動 |

### ペインサイズ調整
| キー | 説明 |
|-----|------|
| `prefix + H` | 左に5マス拡張 |
| `prefix + J` | 下に5マス拡張 |
| `prefix + K` | 上に5マス拡張 |
| `prefix + L` | 右に5マス拡張 |

## ウィンドウ操作（タブのような機能）

### ウィンドウ管理
| キー | 説明 |
|-----|------|
| `prefix + c` | 新しいウィンドウを作成 |
| `prefix + n` | 次のウィンドウに移動 |
| `prefix + p` | 前のウィンドウに移動 |
| `prefix + 1-9` | 指定番号のウィンドウに移動 |
| `prefix + ,` | ウィンドウ名を変更 |
| `prefix + &` | ウィンドウを閉じる |
| `prefix + w` | ウィンドウ一覧を表示 |

## コピーモード（スクロール・テキスト選択）

### 基本操作の流れ
1. `prefix + [` でコピーモード開始
2. カーソル移動で対象位置まで移動
3. `v` で選択開始
4. カーソル移動で選択範囲を拡張
5. `y` でコピー（自動的にコピーモード終了）
6. `prefix + ]` でtmux内ペースト、または `Cmd + V` で他アプリにペースト

### コピーモードの開始と終了
| キー | 説明 |
|-----|------|
| `prefix + [` | コピーモードに入る |
| `q` | コピーモードを終了 |
| `Esc` | コピーモードを終了 |

### 移動操作（Vimスタイル）
| キー | 説明 |
|-----|------|
| `h/j/k/l` | 左/下/上/右にカーソル移動 |
| `w` | 次の単語の先頭に移動 |
| `b` | 前の単語の先頭に移動 |
| `0` | 行の先頭に移動 |
| `$` | 行の末尾に移動 |
| `g` | ファイルの先頭に移動 |
| `G` | ファイルの末尾に移動 |
| `Ctrl + f` | 1画面下にスクロール |
| `Ctrl + b` | 1画面上にスクロール |

### 選択とコピー
| キー | 説明 |
|-----|------|
| `v` | 文字単位の選択開始 |
| `V` | 行単位の選択開始 |
| `Ctrl + v` | 矩形（ブロック）選択開始 |
| `y` | 選択範囲をコピーしてコピーモード終了 |

### 検索
| キー | 説明 |
|-----|------|
| `/` | 前方検索 |
| `?` | 後方検索 |
| `n` | 次の検索結果 |
| `N` | 前の検索結果 |

### ペースト
| キー | 説明 |
|-----|------|
| `prefix + ]` | tmux内でペースト |
| `Cmd + V` | 他アプリでペースト（pbcopy設定により） |

## その他の便利機能

### 設定・情報
| キー | 説明 |
|-----|------|
| `prefix + r` | 設定ファイルをリロード |
| `prefix + ?` | キーバインド一覧を表示 |
| `prefix + t` | 現在時刻を表示 |

## 実用的な使用例

### Web開発セットアップ
```bash
# 1. 開発用セッション作成
tmux new -s dev

# 2. エディタとターミナルに分割
prefix + |    # 縦分割
prefix + -    # 右側を横分割

# 結果:
# ┌──────────┬─────────┐
# │          │ Terminal│
# │ Editor   ├─────────┤
# │          │ Server  │
# └──────────┴─────────┘
```

### システム監視セットアップ
```bash
# 1. 監視用セッション作成
tmux new -s monitor

# 2. 4分割でそれぞれ異なるログ監視
prefix + |    # 縦分割
prefix + -    # 右側を横分割
prefix + h    # 左に移動
prefix + -    # 左側を横分割

# 各ペインで:
# - top (CPU/Memory)
# - tail -f /var/log/nginx/access.log
# - tail -f /var/log/nginx/error.log
# - git status (開発状況)
```

### コピーモード実用例

#### ログからエラーメッセージをコピー
```bash
# 1. サーバーログを監視中にエラー発生
tail -f /var/log/app.log
ERROR: Database connection failed at 2024-01-20 10:30:15

# 2. エラーメッセージをコピー
prefix + [           # コピーモード開始
/ERROR               # エラー行を検索
v                    # 選択開始
$                    # 行末まで選択
y                    # コピー完了

# 3. 別のペインやSlackでエラー報告
prefix + l           # 右のペインに移動
slack-cli send       # エラーメッセージをペースト
```

#### コマンド出力から特定の値を再利用
```bash
# 1. コミットハッシュをコピー
git log --oneline -5
a1b2c3d Fix authentication bug
e4f5g6h Add new feature

# 2. ハッシュをコピーして別のコマンドで使用
prefix + [           # コピーモード開始
0                    # 行の先頭
w                    # 最初の単語（ハッシュ）の先頭
v                    # 選択開始
e                    # 単語の末尾
y                    # コピー

# 3. 別のgitコマンドで使用
git show             # Cmd + V でハッシュをペースト
git cherry-pick      # Cmd + V でハッシュをペースト
```

## トラブルシューティング

### よくある問題と解決法
- **マウスが効かない**: `set -g mouse on` が設定されているか確認
- **Vimでエスケープが遅い**: `set -sg escape-time 0` で解決
- **コピーが効かない**: macOSでは `pbcopy` が必要
- **色がおかしい**: `set -g default-terminal "tmux-256color"` を確認

### 設定反映
```bash
# 設定変更後は必ずリロード
prefix + r

# または手動で
tmux source-file ~/.tmux.conf
```

## 初心者向け学習ステップ

### Step 1: 基本操作を覚える
1. `tmux` でセッション開始
2. `prefix + |` で分割
3. `prefix + h/j/k/l` で移動
4. `prefix + d` でデタッチ
5. `tmux attach` で再接続

### Step 2: 日常使用に慣れる
- 開発時は必ずtmuxを使用
- 画面分割を活用（エディタ+ターミナル）
- セッション名をつける習慣

### Step 3: 上級機能を追加
- ウィンドウ機能の活用
- コピーモードでのテキスト操作
- 独自キーバインドの追加

## プレフィックスキーについて
- デフォルト: `Ctrl + b`
- この設定: `Ctrl + a` (変更済み)
- すべてのtmuxコマンドは「プレフィックス + キー」の組み合わせ
