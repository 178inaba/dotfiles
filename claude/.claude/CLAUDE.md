## コーディング・対応方針

- **言語**: 日本語での質問・回答をお願いします
- **ファイル形式**: ファイルの最後に改行文字を必ず追加してください（POSIX標準準拠）
- **EditorConfig**: プロジェクトに.editorconfigファイルが存在する場合は、その設定に必ず従ってください（indent_style, indent_size, insert_final_newline, end_of_line等）
- **コメント**: 既存のコメント言語（英語/日本語）を踏襲し、コードベース全体で一貫性を保ってください
- **エラーハンドリング**: 言語別パターン
  - **Go言語**: 戻り値を使わない場合、条件文内でエラーハンドリングを行う慣用パターンを使用
    ```go
    // 推奨パターン（戻り値を使わない場合）
    if _, err := someFunction(); err != nil {
        return err
    }
    ```
  - **TypeScript/JavaScript**: エラーオブジェクトを使用しない場合はparameterless catch使用
    ```typescript
    // 推奨パターン（エラーオブジェクト不使用）
    try {
        riskyOperation()
    } catch {
        // エラー処理（オブジェクト不要）
    }

    // エラー詳細が必要な場合のみ
    try {
        riskyOperation()
    } catch (error) {
        console.error(error.message)
    }
    ```

## 差分レビュー方針

詳細: @~/.claude/context/workflows/code-review.md

## テスト開発原則

- **テスト失敗時の対応順序**:
  1. **実装コードの動作確認**: まずブラウザやCLI等で実際の動作を確認
  2. **根本原因の特定**: 実装の問題かテストの問題かを正確に判断
  3. **適切な修正**: 実装に問題があれば実装を修正、テストに問題があればテストを修正
  4. **不要コード削除**: 試行錯誤で追加した不要なモック・デバッグコードをクリーンアップ
- **禁止パターン**: テスト失敗→即座にモック設定変更（根本原因を見逃す）
- **最小限修正**: 必要最小限の変更のみを実施、過度なモック化は避ける

## Git操作規約

- **ブランチ切り替え**: `git switch`を使用（`git checkout`ではなく）
- **コミットメッセージ**: プロジェクト標準に従う

## 開発ワークフロー

- **Sub-Issues管理**: @~/.claude/context/tools/github-sub-issues.md
- **TypeScript/ESLint アップグレード**: @~/.claude/context/workflows/typescript-eslint-upgrade.md
- **大規模機能開発**: @~/.claude/context/workflows/feature-development.md

## 仕様遵守原則

**必須実施事項**: すべての実装作業で以下を厳格に実行すること

### 1. 仕様書の読み間違いを防ぐ方法

#### ✅ チェックリスト方式
実装前に必ず以下を確認：
- [ ] 仕様書の全セクションを読み返した
- [ ] 要件を箇条書きで列挙した
- [ ] 各要件に対応する実装方法を明記した
- [ ] 「〜と同等」「〜相当」などの参照要件を確認した

#### ✅ 要件の構造化
実装前に要件マトリックス表を作成：
```markdown
| 機能 | 要件1 | 要件2 | 要件3 | 実装状況 |
|------|-------|-------|-------|----------|
| 仕様 | XXX   | YYY   | ZZZ   | -        |
| 実装 | ☑️    | ❌    | ☑️    | 2/3完了  |
```

### 2. 実装の簡略化を防ぐ方法

#### ✅ 「なぜ」を必ず記録
すべての実装判断にコメントで理由を明記：
```typescript
// 仕様書 Chapter X.Y により機能Aは全項目対応が必須
// 既存システムと同等の機能を提供する必要がある
```

#### ✅ 勝手な判断の禁止ルール
- 仕様書に明記された要件は**絶対に削除・変更しない**
- 「シンプルにする」「使いやすくする」等の理由で勝手に仕様変更しない
- 仕様変更が必要な場合は必ずユーザーに確認・承認を得る

### 3. 確認不足を防ぐ方法

#### ✅ 段階的確認
各段階で仕様書との照合を実施：
1. **設計時**: 仕様書と設計の対応表作成
2. **実装時**: 各コンポーネント完成後に仕様書と照合
3. **統合時**: システム全体で要件を満たしているか確認

#### ✅ TodoWrite更新時の仕様チェック
Todo更新時に仕様適合状況を併記：
```markdown
- [x] 機能A実装 ← 仕様書 Chapter X.Y ✅対応
- [❌] 機能B実装 ← 仕様書 Chapter X.Z ❌未対応
```

### 実施タイミング

- **実装開始前**: チェックリスト方式 + 要件構造化
- **実装中**: 各ファイル作成後の仕様照合 + 理由記録
- **完了時**: 段階的確認 + TodoWrite仕様チェック
- **報告前**: 全要件に対する実装状況の最終確認

## コンテキスト管理

- **自動更新**: 重要な汎用的コンテキスト（開発ワークフロー、よく使うツール・コマンド、環境設定等）を発見した場合、このCLAUDE.mdまたは適切な context/ ファイルに自動で追記してください
- **分離基準**:
  - CLAUDE.md直接: 基本方針・原則、必須コンテキスト、短くて変更頻度が低いもの
  - context/別ファイル: 詳細ドキュメント、変更頻度が高いもの、特定用途専用のもの
- **リンク形式**: 別ファイル参照時は `@~/.claude/context/カテゴリ/ファイル名.md` 形式を使用
