# /extract-context

## 概要

最近の会話から汎用的・プロジェクト固有のコンテキストを抽出し、適切なCLAUDE.mdファイルに追記するコマンド

## 使用方法

```
/extract-context
```

## 実行内容

### 1. コンテキスト分析
最近の会話を分析して以下を特定：
- **汎用的コンテキスト**: 複数プロジェクトで再利用可能な技術パターン・手法
- **プロジェクト固有コンテキスト**: 特定プロジェクトでのみ有効な実装パターン

### 2. 追記先の決定

#### 汎用的コンテキスト → `~/.claude/CLAUDE.md`
- 開発手法・原則
- 汎用的な実装パターン
- ツール・コマンドの使い方
- 言語横断的なベストプラクティス

#### 汎用的コンテキスト → `~/.claude/context/`
以下の場合は別ファイルに分離：
- 詳細・長文のドキュメント
- 変更頻度が高いもの
- 特定用途専用のもの

#### プロジェクト固有コンテキスト → プロジェクトの`CLAUDE.md`
- そのプロジェクト特有の実装パターン
- プロジェクト固有の技術スタック
- ドメイン特有のビジネスロジック

### 3. 実際の追記実行
- 適切なファイルを特定
- コンテキストを整理・構造化
- 既存内容との重複チェック
- 実際にファイルに追記

## 判断基準

### 汎用的コンテキストの特徴
- [ ] 複数の技術スタック・言語で適用可能な概念・設計パターン
- [ ] フレームワークに依存しない一般的な開発原則
- [ ] 業界標準のアーキテクチャパターン（Clean Architecture、MVC等）
- [ ] 言語横断的なベストプラクティス
- [ ] 汎用的なパフォーマンス最適化手法
- [ ] ユニバーサルなUI/UX設計原則

### プロジェクト固有コンテキストの特徴
- [ ] 特定技術スタックでの具体的実装方法
- [ ] プロジェクト固有のディレクトリ構成・ファイル配置
- [ ] ドメイン特有のビジネスルール・制約
- [ ] プロジェクト固有の命名規則・慣習・設定
- [ ] 特定のライブラリ・サービス・APIとの連携詳細
- [ ] プロジェクト特有の開発・デプロイフロー

## コンテキスト抽出の観点

### 技術パターン
- 実装手法・アーキテクチャパターン
- エラーハンドリング手法
- パフォーマンス最適化
- セキュリティ対策

### 開発プロセス
- コミット・デプロイ戦略
- テスト実装パターン
- コードレビュー手法
- ドキュメント管理

### トラブルシューティング
- よくあるエラーと解決法
- 環境構築での注意点
- デバッグ手法
- 設定ファイルの扱い

### UI/UX パターン
- コンポーネント設計
- 状態管理
- ユーザビリティ改善
- アクセシビリティ対応

## 実行例

### 入力
```
最近の会話でページ状態保持をSessionStorageで実装しました。
サーバーサイドソートも実装しました。
```

### 出力
```
## 発見されたコンテキスト

### 汎用的コンテキスト
- SPA画面遷移での状態保持設計
- 大規模データテーブルでのソート最適化

追記先: ~/.claude/CLAUDE.md

### プロジェクト固有コンテキスト
- Vue 3 + GraphQL環境での具体的実装例

追記先: /path/to/project/CLAUDE.md

## 追記実行結果
✅ グローバルCLAUDE.mdに汎用的パターンを追記しました：
- SPA画面遷移での状態保持設計
- 大規模データテーブルでのソート最適化

✅ プロジェクトCLAUDE.mdに具体的実装例を追記しました：
- Vue 3 + TypeScript + GraphQL環境での実装詳細
```

## 注意事項

1. **既存内容との重複チェック**: 同じパターンが既に記載されていないか確認
2. **適切な粒度**: 細かすぎず、粗すぎない適切なレベルでコンテキストを抽出
3. **実装例の含有**: 単なる概念ではなく、実際のコード例を含む
4. **将来の参照性**: 3ヶ月後に見ても理解できるレベルの詳細度を保つ
5. **分離基準の遵守**: CLAUDE.md直接 vs context/別ファイルの判断を適切に行う

