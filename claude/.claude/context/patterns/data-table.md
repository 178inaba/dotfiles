# 大規模データテーブルでのソート最適化

数千〜数万件のデータを扱うテーブルでのソート機能において、UX・パフォーマンス両面を考慮した設計パターン。

## 基本概念
- **クライアントサイドソート**: 全データをブラウザに読み込んでJavaScriptでソート
- **サーバーサイドソート**: データベースレベルでソートしてページング結果を取得

## サーバーサイドソートが必要な理由
1. **メモリ使用量**: 大量データの全件取得を避ける
2. **初期表示速度**: 必要最小限のデータのみ取得
3. **ネットワーク負荷**: データ転送量の削減
4. **レスポンシブ性**: UIがブロックされない

## 実装パターン

### 1. 数値マッピング方式
- フロントエンド: ソート状態を数値で管理（1=昇順、2=降順）
- バックエンド: 数値からSQL ORDER BY句を生成

### 2. 3状態ソート
- 昇順 → 降順 → デフォルト（無ソート）の順で切り替え
- ユーザーがソートを解除可能

### 3. セカンダリーソート
- 主ソートキーが同値の場合の並び順を一意に決定
- 通常はIDをセカンダリーキーとして使用

## パフォーマンス最適化技法
1. **NULL値の適切な扱い**: `COALESCE`でNULL値を明示的に処理
2. **インデックス活用**: ソート対象カラムにインデックスを設定
3. **JOINの最適化**: 必要最小限のテーブル結合
4. **ページング連携**: LIMIT/OFFSETと組み合わせて使用